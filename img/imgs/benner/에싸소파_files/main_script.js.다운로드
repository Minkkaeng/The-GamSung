jQuery(document).ready(function() {
    /* 메인 팝업 */
    cookiedata = document.cookie;
    if (cookiedata.indexOf("ncookie=done") < 0) {
        document.getElementById('main-popup-wrap').style.display = "block";
        $("#wrap").prepend(
            '<div id="dimm-cookie" onclick="dimm_close();" class="black"/>'
        );
        var mySwiper1 = new Swiper(".main-popup-slider", {
            pagination: true,
            loop: true,
            navigation: {
                nextEl: ".swiper-button-next",
                prevEl: ".swiper-button-prev",
            },
            speed: 700,
            autoplay: {
                delay: 5000,
                disableOnInteraction: true,
            },
            pagination: {
                el: ".swiper-pagination",
                clickable: true,
            },
        });
    } else {
        document.getElementById('main-popup-wrap').style.display = "none";
    }

    /* FIXED 상단 스크롤 */
    if (jQuery(window).scrollTop() == 0) {
        jQuery("#mheader").addClass("fixed");
    } else {
        jQuery("#mheader").removeClass("fixed");
    }
    jQuery(window).scroll(function () {
        if (jQuery(window).scrollTop() == 0) {
            jQuery("#mheader").addClass("fixed");
        } else {
            jQuery("#mheader").removeClass("fixed");
        }
    });

    jQuery("#mheader")
        .mouseenter(function () {
            jQuery("#mheader").removeClass("fixed");
        })
        .mouseleave(function () {
            if (jQuery(window).scrollTop() == 0) {
                jQuery("#mheader").addClass("fixed");
            }
        });

        /* 메인01 : 메인 비주얼 */
        var swiper_sec01 = new Swiper('.swiper_sec01', {            
            slidesPerView: 1,
            watchOverflow: true,
            loop: this.SwiperLength > 1,
            fadeEffect: {
                crossFade: true,
            },
            effect: 'fade',
            speed: 500,
            autoplay: {
                delay: 15000,
                disableOnInteraction: false,
            },
            navigation: {
            	nextEl: '.swiper-button-next-sec01',
            	prevEl: '.swiper-button-prev-sec01',
            },
            pagination: {
                el: '.swiper-pagination-sec01-num',
                clickable: true,
                type: 'fraction',
                formatFractionCurrent: function (number) {
                    return number;
                }
            },
        
            on: {
                init: function() {
                    $(".stick").addClass('pro-ani');
                },
                slideChangeTransitionEnd: function() {
                    $(".stick").addClass('pro-ani');
                },
                slideChangeTransitionStart: function() {
                    $(".stick").removeClass('pro-ani');
                },
                afterInit: function() { // swiper가 정상로드된 후 (swiper 초기화) 이벤트 발생
                  if(this.slides.length == 1) {
                    jQuery('.swiper-controller-box').hide();
                  }
                }
            },
        });

        var sw = 0;
        $('.swiper-button-pp-sec01').click(function(){
            if( sw == 0 ){
                $('.pp-play').show();
                $('.pp-pause').hide();
                $('.pro-ani').addClass('stop');
                swiper_sec01.autoplay.stop();
                sw = 1;
            } else {
                $('.pp-play').hide();
                $('.pp-pause').show();
                $('.pro-ani').removeClass('stop');
                swiper_sec01.autoplay.start();
                sw = 0;
            }
        });

        $('section.mm_sec01 .swiper-pagination-sec01-num em').text('|');
    

        $('.swiper-button-prev-sec01').hover(function() {
            $(".blur_cursor").removeClass("right");
            $(".blur_cursor").addClass("left");
        });
        $('.swiper-button-next-sec01').hover(function() {
            $(".blur_cursor").addClass("right");
            $(".blur_cursor").removeClass("left");
        });

        const cursor = document.querySelector('.blur_cursor');
        const hoverBtnleft = document.querySelector('.swiper-button-prev-sec01');
        const hoverBtnRight = document.querySelector('.swiper-button-next-sec01');

        function animateCursor(e) {
            cursor.style.opacity = 1;
            cursor.style.left = e.pageX + "px";
            cursor.style.top = e.pageY - scrollY + "px";
        }
        function hideCursor(e) {
            cursor.style.opacity = 0;
        }
        
        if (hoverBtnleft || hoverBtnRight){
            hoverBtnleft.addEventListener('mousemove', animateCursor);
            hoverBtnleft.addEventListener('mouseleave', hideCursor);
            hoverBtnRight.addEventListener('mousemove', animateCursor);
            hoverBtnRight.addEventListener('mouseleave', hideCursor);
        }


        /* 메인01 : 메인 비주얼 예전버전 */
        // var swiper_sec01 = new Swiper(".swiper_sec01", {
        //     slidesPerView: 1,
        //     loop: false,
        //     fadeEffect: {
        //         crossFade: true,
        //     },
        //     speed: 1000,
        //     pagination: {
        //         el: ".swiper-pagination-sec01",
        //         type: "progressbar",
        //     },
        // });
        

    /* 메인01 : 메인 공지사항 */
    var swiper_board = new Swiper(".swiper_board", {
        slidesPerView: 1,
        watchOverflow: "true",
        loop: true,
        effect: "fade",
        fadeEffect: {
            crossFade: true,
        },
        speed: 1000,
        autoplay: {
            delay: 7000,
            disableOnInteraction: false,
        },
        navigation: {
            nextEl: ".swiper-button-next-board",
            prevEl: ".swiper-button-prev-board",
        },
        on: {
            init: function () {
                if (
                    jQuery(".swiper_board .swiper-slide").not(
                        ".swiper-slide-duplicate"
                    ).length == 1
                ) {
                    jQuery(".swiper_board").addClass("disabled");
                }
            },
        },
    });

    /* 메인 : 혜택 배너 */
    var swiper_benefitbn = new Swiper(".swiper_benefitbn", {
        speed: 700,
        parallax: true,
        loop: jQuery(".swiper_benefitbn .swiper-slide").length != 1,
        autoplay: {
            delay: 5000,
            disableOnInteraction: false,
        },
        pagination: {
            el: ".swiper-pagination-sect-benefitbn",
            clickable: true,
        },
    });

    /* 메인02 : 탭 상품 */
    jQuery(".mm_sec02 .sec02_tab > div").click(function () {
        if (!jQuery(this).hasClass("open")) {
            var now_tab = jQuery(this).attr("class");
            jQuery(".mm_sec02 .sec02_tab > div").toggleClass("open");
            jQuery(".mm_sec02 .sec02_prd > div").toggleClass("open");
        }
    });

    /* 탭 상품 번호 붙이기 */
    // jQuery('.mm_sec02 div.goods_tab_box').each(function() {
    // 	jQuery(this).find('.num').each(function(index){
    // 		jQuery(this).append(index+1);
    // 	})
    // });

    /* 메인03 : 가로 배너 */
    var swiper_sec03 = new Swiper(".swiper_sec03", {
        slidesPerView: 1,
        watchOverflow: "true",
        loop: true,
        effect: "fade",
        fadeEffect: {
            crossFade: true,
        },
        speed: 1000,
        autoplay: {
            delay: 7000,
            disableOnInteraction: false,
        },
        navigation: {
            nextEl: ".swiper-button-next-sec03",
            prevEl: ".swiper-button-prev-sec03",
        },
    });

    /* 메인04 : ESSA Film */
    var swiper_sec04 = new Swiper(".mm_video .swiper-container", {
        slidesPerView: 1.8,
        spaceBetween: 20,
        centeredSlides: true,
        speed: 1000,
        initialSlide: 3,
        autoHeight: false,
        loop: true,
        navigation: {
            nextEl: ".swiper-button-next.sec-video",
            prevEl: ".swiper-button-prev.sec-video",
        },
    });
    
    /* 메인 : about 배너 */
    var swiper_aboutbn = new Swiper(".swiper_aboutbn", {
        speed: 700,
        loop: true,
        effect : 'fade',
        autoplay: {
            delay: 4000,
            disableOnInteraction: false,
        },
        // pagination: {
        //     el: ".swiper-pagination-sect-aboutbn",
        //     clickable: true,
        // },
    });


    /* 메인05 : 타임세일 스크롤 텍스트 */
    var $horizontal = $(".about_slidemove");
    $(window).scroll(function () {
        var s = $(this).scrollTop(),
            d = $(document).height(),
            c = $(this).height();
        scrollPercent = s / (d - c);
        var position = -scrollPercent * $(document).width();

        $horizontal.css({
            transform: "translate3d(" + (position + 20) + "px, 0px, 0px)",
        });
    });
    
    /* 메인: 키워드샵 */
    var keywordContents = new Swiper('.mm_sect_keywordcontents .swiper-container', {
        speed: 1000,
        loop: false,
        effect : 'fade',
        autoplay: {
            delay: 6000,
            disableOnInteraction: false
        },
        pagination: {
            el: '.mm_sect_keywordcontents .swiper-pagination',
            clickable: true,
            renderBullet: function (index, className) {
                return '<span class="' + className + '">'+$(".mm_sect_keywordcontents .swiper-slide").eq(index).data('slide-title')+"</span>";
            },
        },
    });


    /* 에싸 스토리 */
    var swiper_sect_essastory = new Swiper(".mm_sect_essastory .swiper-container", {
            slidesPerView: 3.3,
            spaceBetween: 15,
            speed: 1000,
            threshold: 5,
            speed: 300,
        }
    );    

});

/* 메인 팝업 관련 함수 */
function setCookie(name, value, expiredays) {
    var todayDate = new Date();
    todayDate.setDate(todayDate.getDate() + expiredays);
    document.cookie = name + "=" + escape(value) + "; path=/; expires=" + todayDate.toGMTString() + ";"
}

function closeWin() {
    document.getElementById('main-popup-wrap').style.display = "none";
    $("#dimm-cookie").remove();
}

function todaycloseWin() {
    setCookie("ncookie", "done", 1);
    document.getElementById('main-popup-wrap').style.display = "none";
    $("#dimm-cookie").remove();
}

function dimm_close() {
    $("#dimm-cookie").remove();
    document.getElementById('main-popup-wrap').style.display = "none";
}



/* 유튜브 영상 모달 */
$(document).ready(function(){
	function toggle_video_modal() {
	    $(".popup-youtube").on("click", function(e){
	        e.preventDefault();
          var id = $(this).attr('data-youtube-id');
          var autoplay = '?autoplay=1';
          var related_no = '&rel=0';
          var src = '//www.youtube.com/embed/'+id+autoplay+related_no;          
          $("#youtube").attr('src', src);
          $("body").addClass("show-video-modal");	    
      });

      function close_video_modal() {        
        event.preventDefault();
        $("body").removeClass("show-video-modal");
        $("#youtube").attr('src', '');        
      }
      
	    $('body').on('click', '.close-video-modal, .video-modal .overlay', function(event) {            
          close_video_modal();	        
      });
      
      $('body').keyup(function(e) {        
          if (e.keyCode == 27) {
            close_video_modal();
          }
      });

	}
	toggle_video_modal();
});